<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Login â€” GraceWise</title><link rel="stylesheet" href="/theme.css"><script src="/core.js"></script></head><body><div class="header"><div class="logo">GW</div><div style="font-weight:700">Login</div></div><div class="container"><div class="panel"><h3>Login</h3><label>Username<input id="loginUser" placeholder="username"></label><label>User ID<input id="loginId" placeholder="ID"></label><label>Password (optional)<input id="loginPass" type="password"></label><div style="display:flex;gap:8px;margin-top:10px"><button id="loginBtn">Login</button><button id="regBtn">Register</button></div><hr><h4>Face Login</h4><div class="small">Use face login (requires face-api models in /public/models)</div><video id="video" width="320" height="240" autoplay muted style="border-radius:8px;display:block;margin-top:10px"></video><div style="display:flex;gap:8px;margin-top:8px"><button id="startCam">Start Camera</button><button id="faceLoginBtn">Face Login</button></div><div id="loginMsg" class="small"></div></div></div><script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script><script>document.getElementById('loginBtn').addEventListener('click', async ()=>{ const u=document.getElementById('loginUser').value.trim(); const id=document.getElementById('loginId').value.trim(); const p=document.getElementById('loginPass').value; const res = await loginCreds(u,id,p); if(res.ok){ alert('Logged in'); location.href='/cards'; } else alert('Login failed: '+(res.error||'')); }); document.getElementById('regBtn').addEventListener('click', async ()=>{ const u=document.getElementById('loginUser').value.trim(); const id=document.getElementById('loginId').value.trim(); const p=document.getElementById('loginPass').value; const res = await registerUser(u,id,p); if(res.ok){ alert('Registered & logged in'); location.href='/cards'; } else alert('Register failed: '+(res.error||'')); }); let stream=null; document.getElementById('startCam').addEventListener('click', async ()=>{ stream = await navigator.mediaDevices.getUserMedia({ video:true }); document.getElementById('video').srcObject = stream; await faceapi.nets.tinyFaceDetector.loadFromUri('/models'); await faceapi.nets.faceRecognitionNet.loadFromUri('/models'); await faceapi.nets.faceLandmark68Net.loadFromUri('/models'); document.getElementById('loginMsg').textContent = 'Models loaded'; }); document.getElementById('faceLoginBtn').addEventListener('click', async ()=>{ const video = document.getElementById('video'); const options = new faceapi.TinyFaceDetectorOptions(); const result = await faceapi.detectSingleFace(video, options).withFaceLandmarks().withFaceDescriptor(); if(!result) return alert('No face detected'); const descriptor = Array.from(result.descriptor); const r = await loginFace(descriptor); if(r.ok){ alert('Face login success'); location.href='/cards'; } else alert('Face login failed: '+(r.error||'')); });</script></body></html>