<!doctype html><html lang="en"><head><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Cards — GraceWise</title><link rel="stylesheet" href="/theme.css"><script src="/core.js"></script></head><body><div class="header"><div style="display:flex;gap:12px;align-items:center"><div class="logo">GW</div><div><div style="font-weight:700;font-size:18px">GraceWise</div><div class="small">Cards & Banks</div></div></div><div style="display:flex;gap:10px;align-items:center"><button onclick="location.href='/settings'">Settings</button></div></div><div class="container"><div class="panel" id="cardFormPanel"><h3>Add or Update Card</h3><div class="small">Set your billing cycle end, due date, interest rate, daily rate and fine.</div><label>Card Name<input id="bankName" placeholder="e.g. CIB Titanium" /></label><label>Cycle End (select date)<input id="bankEnd" type="date" /></label><label>Payment Due (select date)<input id="bankDue" type="date" /></label><label>Annual Rate (%)<input id="bankRate" type="number" step="0.01" min="0" /></label><label>Daily Overdue Rate (%)<input id="bankDaily" type="number" step="0.0001" min="0" placeholder="e.g. 0.115" /></label><label>Late Fine (EGP)<input id="bankFine" type="number" step="0.01" min="0" placeholder="e.g. 50" /></label><div style="display:flex;gap:10px;margin-top:12px"><button id="saveBtn">Save Card</button><button id="newBtn">New</button></div></div><div id="banksPanel" class="panel"><h3>Saved Cards</h3><div id="banksList" class="small">No cards yet.</div></div></div><div class="bottom-nav"><div class="nav-item active" data-path="/cards" onclick="location.href='/cards'">Cards</div><div class="nav-item" data-path="/transactions" onclick="location.href='/transactions'">Transactions</div><div class="nav-item" data-path="/grace" onclick="location.href='/grace'">Grace</div><div class="nav-item" data-path="/settings" onclick="location.href='/settings'">Settings</div></div><script>applyTheme(); setActiveNav('/cards'); function renderBanks(){ const banks = load(BANKS_KEY()); const el = document.getElementById('banksList'); el.innerHTML=''; if(!banks.length){ el.innerHTML='<div class="small">No cards yet.</div>'; return; } banks.forEach(b=>{ const div = document.createElement('div'); div.className='tx-row'; div.innerHTML = `<div><strong>${b.name}</strong><div class="small">Cycle end: ${new Date(b.end).toLocaleDateString()} • Due: ${new Date(b.due).toLocaleDateString()} • Daily ${b.daily}% • Fine ${toEGP(b.fine)}</div></div><div style="display:flex;flex-direction:column;gap:8px"><button onclick="openBank('${b.id}')">Edit</button><button onclick="deleteBank('${b.id}')">Delete</button></div>`; el.appendChild(div); }); } function openBank(id){ const banks = load(BANKS_KEY()); const b = banks.find(x=>x.id===id); if(!b) return; document.getElementById('bankName').value=b.name; document.getElementById('bankEnd').value=b.end; document.getElementById('bankDue').value=b.due; document.getElementById('bankRate').value=b.rate; document.getElementById('bankDaily').value=b.daily; document.getElementById('bankFine').value=b.fine; } function deleteBank(id){ if(!confirm('Delete this card?')) return; const banks = load(BANKS_KEY()).filter(b=>b.id!==id); save(BANKS_KEY(), banks); renderBanks(); } document.getElementById('saveBtn').addEventListener('click', ()=>{ const nameEl=document.getElementById('bankName'); const endEl=document.getElementById('bankEnd'); const dueEl=document.getElementById('bankDue'); const annualEl=document.getElementById('bankRate'); const dailyEl=document.getElementById('bankDaily'); const fineEl=document.getElementById('bankFine'); const firstInvalid = validateCardFormElements(nameEl,endEl,dueEl,annualEl,dailyEl,fineEl); if(firstInvalid){ scrollToInvalid(firstInvalid); return; } const banks = load(BANKS_KEY()); const name = nameEl.value.trim(); const existing = banks.find(b=>b.name.toLowerCase()===name.toLowerCase()); const payload = { id: existing? existing.id : uid(), name, end: endEl.value, due: dueEl.value, rate: parseFloat(annualEl.value||'0'), daily: parseFloat(dailyEl.value||'0'), fine: parseFloat(fineEl.value||'0') }; if(existing){ const idx=banks.findIndex(x=>x.id===existing.id); banks[idx]=payload; } else banks.push(payload); save(BANKS_KEY(), banks); renderBanks(); // visual feedback
  alert('Card saved'); }); document.getElementById('newBtn').addEventListener('click', ()=>{ ['bankName','bankEnd','bankDue','bankRate','bankDaily','bankFine'].forEach(id=>{ document.getElementById(id).value=''; clearInvalid(document.getElementById(id)); }); }); document.addEventListener('DOMContentLoaded', ()=>{ renderBanks(); bindRateSync(document.getElementById('bankRate'), document.getElementById('bankDaily')); });</script></body></html>