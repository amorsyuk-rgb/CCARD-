<!doctype html>
<html lang="en">
<head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Grace - GraceWise v5.9</title>
<link rel="stylesheet" href="theme.css">
<style>body{font-family:Inter,Arial;background:#0f0f0f;color:#e6e6e6;margin:0;padding:12px} .panel{background:rgba(255,255,255,0.03);padding:12px;border-radius:8px}</style>
</head><body>
<header style="background:linear-gradient(90deg,#005BAC,#F37021);padding:12px;color:#fff;font-weight:700">GraceWise â€” Grace Analysis</header>
<div style="max-width:920px;margin:12px auto">
  <div class="panel">
    <h3>Grace Calculator</h3>
    <label>Card<select id="cardSel"></select></label>
    <label>Purchase Date<input id="purchaseDate" type="date"></label>
    <div style="margin-top:8px"><button id="calcBtn" style="padding:8px 12px;background:linear-gradient(90deg,#005BAC,#F37021);color:#fff;border-radius:8px">Calculate</button></div>
    <div id="result" style="margin-top:12px"></div>
  </div>
</div>
<script src="core.js"></script>
<script>
function load(k){ try{ return JSON.parse(localStorage.getItem(k)||'[]')}catch(e){return[]} }
const CARD_KEY = (typeof BANKS_KEY === 'function') ? BANKS_KEY() : 'gw_banks_guest';
function populate(){ const sel=document.getElementById('cardSel'); sel.innerHTML=''; const cards=load(CARD_KEY); if(!cards.length){ sel.innerHTML='<option value="">-- No cards --</option>'; return; } sel.innerHTML='<option value="">-- Select --</option>'; cards.forEach(c=>{ const o=document.createElement('option'); o.value=c.id; o.text=c.name; sel.appendChild(o); }); }
document.getElementById('calcBtn').addEventListener('click', ()=>{ const cid=document.getElementById('cardSel').value; const dt=document.getElementById('purchaseDate').value; if(!cid){ alert('Select card'); return;} if(!dt){ alert('Pick date'); return;} const cards=load(CARD_KEY); const card=cards.find(x=>x.id===cid); if(!card){ alert('Card not found'); return;} const dummyTx={amount:1,date:dt}; const analysis=computeTransactionAnalysis(dummyTx, card, new Date()); const r=document.getElementById('result'); r.innerHTML = '<div>Purchase: '+ (analysis.purchase?analysis.purchase.toLocaleDateString():'-') + '</div>' + '<div>Due: '+ (analysis.dueDate?analysis.dueDate.toLocaleDateString():'-') + '</div>' + '<div>Grace Days: '+ (analysis.graceDays) + '</div>' + '<div>Status: <span style="color:'+analysis.color+'">'+analysis.status+'</span></div>'; });
populate();
</script>
</body></html>
