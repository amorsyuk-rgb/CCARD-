<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>GraceWise — Smart Credit Dashboard v4</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/icon?family=Material+Icons+Outlined" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<style>
:root{
  --cib-blue:#005BAC;
  --cib-orange:#F37021;
  --cib-bg:#F8F9FB;
  --cib-text:#1B1B1B;
  --okx-bg:#0b0f14;
  --okx-text:#e6eef3;
  --muted:#76808a;
}
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;background:var(--cib-bg);color:var(--cib-text)}
.container{max-width:1100px;margin:12px auto;padding:8px}
.header{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:10px;background:linear-gradient(90deg,var(--cib-blue),var(--cib-orange));color:white;gap:12px}
.brand{display:flex;align-items:center;gap:12px}
.logo-wrap{width:44px;height:44px;border-radius:8px;background:rgba(255,255,255,0.08);display:flex;align-items:center;justify-content:center;font-weight:700;color:white;font-size:18px}
.title{font-weight:700;font-size:16px}
.header-controls{display:flex;gap:8px;align-items:center}
.icon-btn{background:rgba(255,255,255,0.12);border:0;color:white;padding:8px 10px;border-radius:8px;cursor:pointer}
.main{display:flex;gap:12px;margin-top:12px}
.left{width:360px}
.right{flex:1}
.panel{background:white;border-radius:10px;padding:12px;box-shadow:0 6px 20px rgba(10,20,30,0.04);margin-bottom:12px}
.tab-section{display:none}
.tab-section.active{display:block}
label{display:block;font-size:13px;color:var(--muted);margin-top:8px}
input,select,button,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #e6e9ee;background:white}
.bank-item, .tx-row{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;border:1px solid #eef2f5;margin-top:8px}
.bottom-nav{position:fixed;left:0;right:0;bottom:0;height:64px;background:rgba(255,255,255,0.98);display:flex;justify-content:space-around;align-items:center;border-top:1px solid #e6e9ee}
.bottom-nav .nav-item{flex:1;display:flex;align-items:center;justify-content:center;gap:8px;cursor:pointer;padding:10px 6px;color:var(--muted);font-weight:600}
.bottom-nav .nav-item.active{color:var(--cib-blue);background:linear-gradient(90deg, rgba(0,90,180,0.06), rgba(243,112,33,0.03));}
.material-icons-outlined{font-size:20px}
@media(max-width:900px){.main{flex-direction:column}.left{width:100%}.bottom-nav{height:72px}}
.small{font-size:13px;color:var(--muted)}
#splash{position:fixed;inset:0;background:linear-gradient(90deg,var(--cib-blue),var(--cib-orange));display:flex;align-items:center;justify-content:center;flex-direction:column;color:white;z-index:9999}
.splash-box{width:140px;height:140px;border-radius:18px;display:flex;align-items:center;justify-content:center;background:rgba(255,255,255,0.06);font-weight:800;font-size:44px}
.splash-sub{margin-top:12px;opacity:0.95;font-size:14px}
.small-btn{background:#f3f4f6;border-radius:8px;padding:8px 10px;border:0;cursor:pointer}
.footer{font-size:13px;color:var(--muted);margin-top:12px;text-align:center}
.dark body{background:linear-gradient(180deg,#02040a,#071018)}
.dark .panel{background:#0f1419;color:var(--okx-text)}
</style>
</head>
<body>
<div id="splash">
  <div class="splash-box">GW</div>
  <div class="splash-sub">GraceWise — Smart Credit Dashboard</div>
</div>
<div id="app" class="container" style="display:none">
  <div class="header" id="header">
    <div class="brand">
      <div class="logo-wrap" id="logo">GW</div>
      <div>
        <div class="title">GraceWise</div>
        <div class="subtitle">Smart Credit Dashboard</div>
      </div>
    </div>
    <div class="header-controls">
      <button class="icon-btn" id="themeToggle"><span class="material-icons-outlined">brightness_6</span>Theme</button>
      <button class="icon-btn" id="exportBtn"><span class="material-icons-outlined">save_alt</span>Export</button>
    </div>
  </div>
  <div class="main">
    <div class="left">
      <div class="panel">
        <div id="tabCards" class="tab-section">
          <h3>Cards / Banks</h3>
          <div class="small">Create or edit cards. Annual rate & default interest method.</div>
          <label>Card name<input id="bankName" placeholder="e.g. CIB Mastercard"></label>
          <label>Cycle Start<input id="bankStart" type="date"></label>
          <label>Cycle End<input id="bankEnd" type="date"></label>
          <label>Due Date<input id="bankDue" type="date"></label>
          <label>Annual Rate (%)<input id="bankRate" type="number" step="0.01" placeholder="e.g. 24"></label>
          <label>Default Interest Method<select id="bankMethod"><option value="simple">Simple</option><option value="compound">Compound (daily)</option></select></label>
          <div style="display:flex;gap:8px;margin-top:10px">
            <button id="saveBank">Save / Update</button>
            <button id="newBank" class="small-btn">New</button>
          </div>
          <div id="banksList"></div>
        </div>
        <div id="tabSettings" class="tab-section">
          <h3>Settings</h3>
          <div class="small">Theme, export/import, reset data, and app info.</div>
          <label>Theme<select id="settingsTheme"><option value="cib">CIB Light</option><option value="dark">Dark OKX</option></select></label>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="exportAll" class="small-btn">Export JSON</button>
            <label class="small-btn" style="display:inline-block;cursor:pointer">Import JSON <input id="importFile" type="file" accept="application/json" style="display:none"></label>
          </div>
          <div style="margin-top:8px">
            <button id="clearData" class="small-btn">Clear All Data</button>
            <button id="restoreDefaults" class="small-btn">Restore Defaults</button>
          </div>
          <div class="footer">GraceWise v4.0 © 2025 — Designed for smart credit insights.</div>
        </div>
      </div>
    </div>
    <div class="right">
      <div class="panel">
        <div id="tabTx" class="tab-section active">
          <h3>Transactions</h3>
          <div class="small">Register purchases, track due dates and interest.</div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <select id="txCard"></select>
            <input id="txDate" type="date" style="width:150px">
            <input id="txAmount" type="number" placeholder="EGP" style="width:120px">
          </div>
          <label>Description<input id="txDesc" placeholder="Merchant or note"></label>
          <label>Interest method override<select id="txMethod"><option value="">Use card default</option><option value="simple">Simple</option><option value="compound">Compound</option></select></label>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="addTx">Add Transaction</button>
            <button id="clearTx" class="small-btn">Clear</button>
          </div>
          <div id="txPanel" style="margin-top:12px;display:none">
            <h4>Transactions list</h4>
            <div id="txList"></div>
          </div>
        </div>
        <div id="tabGrace" class="tab-section">
          <h3>Grace Analysis</h3>
          <div class="small">Grace period trend and this-week overview.</div>
          <canvas id="trendChart"></canvas>
          <canvas id="weekChart" style="margin-top:10px"></canvas>
        </div>
        <div id="tabInsights" class="tab-section">
          <h3>Insights</h3>
          <div class="small">Aggregated totals, overdue distribution, and per-card charts.</div>
          <div id="insightsContent"></div>
        </div>
      </div>
    </div>
  </div>
  <div class="bottom-nav" id="bottomNav">
    <div class="nav-item" data-target="tabCards"><span class="material-icons-outlined">account_balance</span><span>Cards</span></div>
    <div class="nav-item active" data-target="tabTx"><span class="material-icons-outlined">credit_card</span><span>Transactions</span></div>
    <div class="nav-item" data-target="tabGrace"><span class="material-icons-outlined">show_chart</span><span>Grace</span></div>
    <div class="nav-item" data-target="tabInsights"><span class="material-icons-outlined">insights</span><span>Insights</span></div>
    <div class="nav-item" data-target="tabSettings"><span class="material-icons-outlined">settings</span><span>Settings</span></div>
  </div>
</div>

<script>
const BANKS_KEY='gw_v4_banks', TX_KEY='gw_v4_tx', THEME_KEY='gw_v4_theme', LAST_TAB='gw_v4_last_tab';
function uid(){return Math.random().toString(36).slice(2,9)}
function load(k){try{return JSON.parse(localStorage.getItem(k)||'[]')}catch{return[]}}
function save(k,v){localStorage.setItem(k,JSON.stringify(v))}
function setVal(k,v){localStorage.setItem(k,v)}
function getVal(k){return localStorage.getItem(k)}
function fmt(d){return new Date(d).toLocaleDateString()}
function parseDate(v){return v?new Date(v+'T00:00:00'):null}
function daysDiff(a,b){return Math.round((b-a)/(1000*60*60*24))}
function toEGP(n){return 'EGP '+Number(n||0).toLocaleString('en-US',{minimumFractionDigits:2,maximumFractionDigits:2})}
function simpleInterest(amount,annual,days){const daily=(annual/100)/365;return amount*daily*days}
function compoundInterest(amount,annual,days){const daily=(annual/100)/365;return amount*(Math.pow(1+daily,days)-1)}
let theme = getVal(THEME_KEY) || 'cib';
function applyTheme(){ if(theme==='dark'){document.documentElement.classList.add('dark'); document.body.style.background='linear-gradient(180deg,#02040a,#071018)'; document.querySelector('.header').style.background='linear-gradient(90deg,#071025,#00122b)'; } else { document.documentElement.classList.remove('dark'); document.body.style.background='var(--cib-bg)'; document.querySelector('.header').style.background='linear-gradient(90deg,var(--cib-blue),var(--cib-orange))'; } setVal(THEME_KEY,theme); if(document.getElementById('settingsTheme')) document.getElementById('settingsTheme').value=theme; }
window.addEventListener('load',()=>{ setTimeout(()=>{ document.getElementById('splash').style.display='none'; document.getElementById('app').style.display='block'; init(); },700); });
const refs={ banksList:document.getElementById('banksList'), txCard:document.getElementById('txCard'), txList:document.getElementById('txList'), txPanel:document.getElementById('txPanel') };
function init(){ applyTheme(); bindUI(); renderBanks(); renderTxCards(); const last=getVal(LAST_TAB)||'tabTx'; openTab(last); document.querySelectorAll('.bottom-nav .nav-item').forEach(n=>{ n.classList.toggle('active', n.dataset.target===last); }); }
function bindUI(){ document.getElementById('themeToggle').onclick = ()=>{ theme = (theme==='cib'?'dark':'cib'); applyTheme(); }; document.getElementById('exportBtn').onclick = exportData; document.getElementById('saveBank').onclick = saveBank; document.getElementById('newBank').onclick = ()=>{ document.getElementById('bankName').value=''; document.getElementById('bankStart').value=''; document.getElementById('bankEnd').value=''; document.getElementById('bankDue').value=''; document.getElementById('bankRate').value=''; }; document.getElementById('addTx').onclick = addTransaction; document.getElementById('clearTx').onclick = ()=>{ document.getElementById('txDate').value=''; document.getElementById('txAmount').value=''; document.getElementById('txDesc').value=''; document.getElementById('txMethod').value=''; }; document.querySelectorAll('.bottom-nav .nav-item').forEach(n=>n.addEventListener('click', ()=>{ openTab(n.dataset.target); document.querySelectorAll('.bottom-nav .nav-item').forEach(x=>x.classList.remove('active')); n.classList.add('active'); setVal(LAST_TAB,n.dataset.target); })); document.getElementById('settingsTheme').addEventListener('change', (e)=>{ theme = e.target.value; applyTheme(); }); document.getElementById('exportAll').addEventListener('click', exportData); document.getElementById('importFile').addEventListener('change', importData); document.getElementById('clearData').addEventListener('click', clearAllData); document.getElementById('restoreDefaults').addEventListener('click', restoreDefaults); }
function openTab(id){ document.querySelectorAll('.tab-section').forEach(s=>s.classList.remove('active')); const el=document.getElementById(id); if(el) el.classList.add('active'); if(id==='tabTx' && load(TX_KEY).length>0) refs.txPanel.style.display='block'; else refs.txPanel.style.display='none'; setVal(LAST_TAB,id); }
function renderBanks(){ const banks = load(BANKS_KEY); refs.banksList.innerHTML=''; refs.txCard.innerHTML=''; if(!banks.length){ refs.banksList.innerHTML='<div class="small">No cards yet.</div>'; refs.txCard.innerHTML='<option value="">No card</option>'; return; } banks.forEach(b=>{ const div=document.createElement('div'); div.className='bank-item'; div.innerHTML = '<div><strong>'+b.name+'</strong><div class="small">'+fmt(b.start)+' to '+fmt(b.end)+'</div><div class="small">Due '+fmt(b.due)+' • '+b.rate+'% • '+b.method+'</div></div><div><button class="small-btn" data-id="'+b.id+'">Open</button></div>'; div.querySelector('button').onclick = ()=>{ openTab('tabCards'); document.getElementById('bankName').value=b.name; document.getElementById('bankStart').value=b.start; document.getElementById('bankEnd').value=b.end; document.getElementById('bankDue').value=b.due; document.getElementById('bankRate').value=b.rate; document.getElementById('bankMethod').value=b.method; }; refs.banksList.appendChild(div); const opt=document.createElement('option'); opt.value=b.id; opt.textContent=b.name; refs.txCard.appendChild(opt); }); }
function saveBank(){ const name=document.getElementById('bankName').value.trim(); const start=document.getElementById('bankStart').value; const end=document.getElementById('bankEnd').value; const due=document.getElementById('bankDue').value; const rate=parseFloat(document.getElementById('bankRate').value); const method=document.getElementById('bankMethod').value; if(!name||!start||!end||!due||isNaN(rate)){ alert('Please fill all card fields'); return; } const banks = load(BANKS_KEY); const existing = banks.find(x=>x.name.toLowerCase()===name.toLowerCase()); if(existing){ existing.start=start; existing.end=end; existing.due=due; existing.rate=rate; existing.method=method; } else { banks.push({id:uid(),name,start,end,due,rate,method}); } save(BANKS_KEY,banks); renderBanks(); alert('Saved'); document.getElementById('bankName').value=''; renderTxCards(); }
function renderTxCards(){ const banks=load(BANKS_KEY); refs.txCard.innerHTML=''; if(!banks.length){ refs.txCard.innerHTML='<option value="">No card</option>'; return;} banks.forEach(b=>{ const opt=document.createElement('option'); opt.value=b.id; opt.textContent=b.name; refs.txCard.appendChild(opt); }); if(banks.length && !window._selectedBank) { window._selectedBank = banks[0].id; } }
function addTransaction(){ const bankId=document.getElementById('txCard').value; const date=document.getElementById('txDate').value; const amt=parseFloat(document.getElementById('txAmount').value); const desc=document.getElementById('txDesc').value.trim(); const method=document.getElementById('txMethod').value||null; if(!bankId||!date||isNaN(amt)||amt<=0){ alert('Fill transaction fields'); return; } const banks=load(BANKS_KEY); const b=banks.find(x=>x.id===bankId); if(!b){ alert('Card not found'); return; } const p=parseDate(date); const s=parseDate(b.start); const e=parseDate(b.end); if(p<s||p>e){ if(!confirm('Purchase date outside cycle. Add anyway?')) return; } const txs=load(TX_KEY); txs.push({id:uid(),bankId,date,amount:Math.round(amt*100)/100,desc,methodOverride:method}); save(TX_KEY,txs); document.getElementById('txDate').value=''; document.getElementById('txAmount').value=''; document.getElementById('txDesc').value=''; document.getElementById('txMethod').value=''; buildTxPanel(b); alert('Transaction added'); }
function buildTxPanel(bank){ const txs = load(TX_KEY).filter(t=>t.bankId===bank.id).sort((a,b)=>new Date(a.date)-new Date(b.date)); refs.txList.innerHTML=''; let sumP=0,sumI=0; let counts={active:0,near:0,over:0}; const today=new Date(); txs.forEach(tx=>{ const purchase=parseDate(tx.date); const due=parseDate(bank.due); const grace=daysDiff(purchase,due); const overdue=Math.max(0,daysDiff(due,today)); const method=tx.methodOverride||bank.method; let interest=0; let total=tx.amount; if(overdue>0){ if(method==='compound') interest=compoundInterest(tx.amount,bank.rate,overdue); else interest=simpleInterest(tx.amount,bank.rate,overdue); total=tx.amount+interest; } sumP+=tx.amount; sumI+=interest; const status = daysDiff(today,due) < 0 ? 'active' : (daysDiff(today,due) <=5 ? 'near' : 'over'); counts[status==='active'?'active':status==='near'?'near':'over']++; const div=document.createElement('div'); div.className='tx-row'; div.innerHTML='<div><strong>'+ (tx.desc||'Purchase') +'</strong><div class="small">'+fmt(purchase)+' • Due '+fmt(due)+' • Grace '+grace+'d</div></div><div style="text-align:right"><div style="font-weight:700">'+toEGP(tx.amount)+'</div><div class="small">Interest: '+toEGP(interest)+'</div><div class="small">Total: '+toEGP(total)+'</div><div style="margin-top:8px"><span class="small-btn">'+status.toUpperCase()+'</span> <button data-id="'+tx.id+'" class="small-btn edit">Edit</button> <button data-id="'+tx.id+'" class="small-btn del">Del</button></div></div>'; refs.txList.appendChild(div); }); refs.txList.querySelectorAll('.del').forEach(b=>b.onclick=(e)=>{ const id=e.target.dataset.id; if(!confirm('Delete transaction?')) return; const arr=load(TX_KEY).filter(t=>t.id!==id); save(TX_KEY,arr); buildTxPanel(bank); }); refs.txList.querySelectorAll('.edit').forEach(b=>b.onclick=(e)=>{ const id=e.target.dataset.id; const tx=load(TX_KEY).find(t=>t.id===id); if(!tx) return; document.getElementById('txCard').value=tx.bankId; document.getElementById('txDate').value=tx.date; document.getElementById('txAmount').value=tx.amount; document.getElementById('txDesc').value=tx.desc; document.getElementById('txMethod').value=tx.methodOverride||''; const rest=load(TX_KEY).filter(t=>t.id!==id); save(TX_KEY,rest); buildTxPanel(bank); }); const totals=document.createElement('div'); totals.style.marginTop='8px'; totals.innerHTML='<div class="small">Outstanding principal: <strong>'+toEGP(sumP)+'</strong></div><div class="small">Accrued interest: <strong>'+toEGP(sumI)+'</strong></div><div class="small">Active / Near / Overdue: <strong>'+counts.active+' / '+counts.near+' / '+counts.over+'</strong></div><div class="small">Intersection rate: <strong>'+(txs.length?((counts.over/txs.length*100).toFixed(1))+'%':'')+'</strong></div>'; refs.txList.appendChild(totals); buildCharts(bank,txs); }
function buildCharts(bank, transactions){ const due=parseDate(bank.due); const today=new Date(); const labels=transactions.map(t=>fmt(parseDate(t.date))); const graceData=transactions.map(t=>daysDiff(parseDate(t.date),due)); const amounts=transactions.map(t=>t.amount); if(window.trendChart) window.trendChart.destroy(); const ctx=document.getElementById('trendChart').getContext('2d'); window.trendChart = new Chart(ctx, { type:'line', data:{ labels, datasets:[{ label:'Grace (days)', data:graceData, borderColor: theme==='dark'?'#00a3ff':'#005BAC', backgroundColor: theme==='dark'?'rgba(0,163,255,0.12)':'rgba(0,90,180,0.08)', fill:true, tension:0.3, pointRadius:6 }, { label:'Amount (EGP)', data:amounts, type:'bar', yAxisID:'y1', backgroundColor:'rgba(34,197,94,0.6)' }] }, options:{ responsive:true, interaction:{mode:'index',intersect:false}, scales:{ y:{ title:{ display:true, text:'Grace days' } }, y1:{ position:'right', grid:{ display:false }, title:{ display:true, text:'Amount (EGP)' } } }, plugins:{ tooltip:{ callbacks:{ label:function(ctx){ const i=ctx.dataIndex; const t=transactions[i]; if(!t) return ''; const p=fmt(parseDate(t.date)); const g=daysDiff(parseDate(t.date),due); const dueS=fmt(due); const over=Math.max(0,daysDiff(due,today)); const method=t.methodOverride||bank.method; const interest= over>0 ? (method==='compound'?compoundInterest(t.amount,bank.rate,over):simpleInterest(t.amount,bank.rate,over)) : 0; return ['Purchase: '+p, 'Due: '+dueS, 'Grace: '+g+' days', 'Interest(if overdue): '+toEGP(interest) ]; } } } , title:{ display:true, text:'Grace trend (per transaction)' } } } }); if(window.weekChart) window.weekChart.destroy(); const ctx2=document.getElementById('weekChart').getContext('2d'); const today2=new Date(); const startWeek=new Date(today2); startWeek.setDate(today2.getDate()-today2.getDay()); startWeek.setHours(0,0,0,0); const weekLabels=[]; const weekVals=[]; for(let d=new Date(startWeek); d<=new Date(startWeek.getTime()+6*24*3600*1000); d.setDate(d.getDate()+1)){ weekLabels.push(fmt(d)); weekVals.push(daysDiff(d,due)); } window.weekChart = new Chart(ctx2,{ type:'bar', data:{ labels:weekLabels, datasets:[{ label:"This week's grace", data:weekVals, backgroundColor:'#F37021' }] }, options:{ responsive:true, plugins:{ legend:{ display:false }, title:{ display:true, text:"This Week's Grace Overview" } }, scales:{ y:{ beginAtZero:true, title:{ display:true, text:'Days' } } } } }); }
function renderInsights(){ const banks=load(BANKS_KEY); const txs=load(TX_KEY); const container=document.getElementById('insightsContent'); container.innerHTML=''; if(!banks.length){ container.innerHTML='<div class="small">No data to analyze.</div>'; return; } banks.forEach(b=>{ const bankTx=txs.filter(t=>t.bankId===b.id); let total=0, interest=0; const today=new Date(); bankTx.forEach(tx=>{ total+=tx.amount; const over=Math.max(0,daysDiff(parseDate(b.due),today)); const method=tx.methodOverride||b.method; if(over>0){ interest += (method==='compound'?compoundInterest(tx.amount,b.rate,over):simpleInterest(tx.amount,b.rate,over)); } }); const div=document.createElement('div'); div.className='panel'; div.innerHTML='<h4>'+b.name+'</h4><div class="small">Outstanding: <strong>'+toEGP(total)+'</strong> • Accrued interest: <strong>'+toEGP(interest)+'</strong></div>'; container.appendChild(div); }); }
function exportData(){ const data={ banks:load(BANKS_KEY), tx:load(TX_KEY), theme:theme }; const blob=new Blob([JSON.stringify(data, null, 2)], {type:'application/json'}); const url=URL.createObjectURL(blob); const a=document.createElement('a'); a.href=url; a.download='gracewise_export.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url); }
function importData(e){ const file=e.target.files[0]; if(!file) return; const reader=new FileReader(); reader.onload=function(){ try{ const data=JSON.parse(reader.result); if(data.banks) localStorage.setItem(BANKS_KEY,JSON.stringify(data.banks)); if(data.tx) localStorage.setItem(TX_KEY,JSON.stringify(data.tx)); if(data.theme) { theme=data.theme; applyTheme(); } renderBanks(); renderTxCards(); alert('Imported'); }catch(err){ alert('Invalid JSON'); } }; reader.readAsText(file); }

function clearAllData(){ if(!confirm('Clear all saved banks and transactions?')) return; localStorage.removeItem(BANKS_KEY); localStorage.removeItem(TX_KEY); renderBanks(); renderTxCards(); alert('Cleared'); }
function restoreDefaults(){ if(!confirm('Restore defaults and clear data?')) return; localStorage.clear(); theme='cib'; applyTheme(); renderBanks(); renderTxCards(); alert('Restored'); }
function buildTxPanelFromSelected(){ const banks=load(BANKS_KEY); const id=document.getElementById('txCard').value; const b=banks.find(x=>x.id===id); if(b) { document.getElementById('txPanel').style.display='block'; buildTxPanel(b);} else document.getElementById('txPanel').style.display='none'; }
document.addEventListener('DOMContentLoaded',()=>{ applyTheme(); renderBanks(); renderTxCards(); const last=getVal(LAST_TAB)||'tabTx'; openTab(last); document.querySelectorAll('.bottom-nav .nav-item').forEach(n=>n.classList.toggle('active', n.dataset.target===last)); document.getElementById('txCard').addEventListener('change',()=>{ buildTxPanelFromSelected(); }); document.getElementById('txCard').addEventListener('change',()=>{ const bId=document.getElementById('txCard').value; const banks=load(BANKS_KEY); const b=banks.find(x=>x.id===bId); if(b) buildTxPanel(b); }); });
</script>
</body>
</html>
